---
title: "FA542 - Midterm Exam"
subtitle: "I pledge my honor that I have abided by the Stevens Honor System."
author: "Sid Bhatia"
date: "2023-10-26"
output: pdf_document
---

## Problem 1 (20pt)

Let $p_t$ be the the log price of an asset at time $t$. Assume that the log price follows the model:

$$p_t = 0.001 + p_{t-1} + a_t, \; a_t \sim \mathcal{N}(\mu = 0, \sigma^2 = 0.16)$$

where $\mathcal{N}(\mu, \sigma^2)$ denotes normal distribution with mean $\mu$ and variance $\sigma^2$.

Assume further that $p_{200} = 4.551$.

#### a.

*Compute the $95\%$ interval forecast for $p_{201}$ at the forecast origin $t = 200$.*

For $t = 201$:

$$p_{201} = 0.001 + 4.551 + a_{201}$$

If we take the conditional expectation of this, we have end up with the following:

$$\mathbb{E}[p_{201} | \mathcal{F}] = 4.552 + \mathbb{E}[a_{201}] = 4.552$$.

The variance of $p_{201}$ is the variance of $a_{201}$, therefore the standard deviation is $\sigma = \sqrt{0.16} = 0.4$.

As such, the $95\%$ CI is:

$$p_{201} \pm 1.96 * \sigma$$

```{r}
set.seed(100)

# Establish coefficients for AR(1) model.
phi_0 <- 0.001
phi_1 <- 1
a_t <- 0.16

p_200 <- 4.551

# Compute conditional expectation forecast.
p_201 <- phi_0 + p_200

p_201

# Compute forecast incorporating white noise.
forecast_1_step <- phi_0 + p_200 + rnorm(1, mean = 0, sd = sqrt(a_t))
forecast_1_step

# Compute z-score for \alpha = 0.05
z_score <- qnorm(0.975)

# Create 95% for forecast.
lower_bound <- p_201 - (z_score * sqrt(a_t))
upper_bound <- p_201 + (z_score * sqrt(a_t))

confidence_interval <- c(lower_bound, upper_bound)

confidence_interval
```

#### b.

*Compute the 2-step ahead point forecast and its standard error for $p_{202}$ at the forecast origin $t = 200$.*

$$p_{202} = 0.001 + p_{201} + a_t = 0.001 + 4.552 + a_{202}$$.

If we take the conditional expectation of this, we have end up with the following:

$$\mathbb{E}[p_{202} | \mathcal{F}] = 4.553 + \mathbb{E}[a_{202}] = 4.553$$.

The standard deviation of the forecast error at time $n + m$ is:

$$SE(x^n_{n+m} - x_{n+m}) = \sqrt{\hat{\sigma}_w^2 \sum_{j=0}^{m-1} \phi^2_j}$$

When forecasting $m = 1$ time past the end of the series, the SE of the forecast is:

$$SE(x^n_{n+1} - x_{n+1}) = \sqrt{\hat{\sigma}_w^2 (1)}$$

When forecasting $m = 2$ time past the end of the series, the SE of the forecast is:

$$SE(x^n_{n+2} - x_{n+2}) = \sqrt{\hat{\sigma}_w^2 (1 + \phi_1^2)}$$

In this case, $\phi_1 = 1$.

Therefore, the SE of the forecast is:

$$\sqrt{0.16 * (1 + 1)} = \sqrt{0.32} = 0.5656854$$.

```{r}
# Compute conditional expectation forecast.
p_202 <- phi_0 + p_201
p_202

# Compute forecast incorporating white noise.
forecast_2_step <- phi_0 + p_201 + rnorm(1, mean = 0, sd = sqrt(a_t))
forecast_2_step

# Compute forecast step error.
forecast_2_step_SE <- sqrt(0.16 * 2)
forecast_2_step_SE
```

#### c.

*What is the 100-step ahead forecast for $p_{300}$ at the forecast origin $t = 200$?*

$$p_{300} = p_{200} + 100 * phi_0 + a_t = 4.551 + 0.1 + a_t$$

If we take the conditional expectation of this, we have end up with the following:

$$\mathbb{E}[p_{300} | \mathcal{F}] = 4.651 + \mathbb{E}[a_{202}] = 4.651$$.

```{r}
# Compute forecast incorporating white noise.
forecast_100_step <- 100 * phi_0 + p_200 + rnorm(1, mean = 0, sd = sqrt(a_t))
forecast_100_step
```

## Problem 2

Suppose that the quarterly growth rates $r_t$ of an economy follows the model:

$$r_t = 0.006 + 0.168r_{t-1} + 0.338r_{t-2} - 0.189r_{t-3} + a_t, \; a_t \sim \mathcal{N}(\mu = 0, \sigma^2 = 0.0016)$$

#### a.

*What is the expected growth rate of $r_t$?*

$$\mathbb{E}[r_t] = \frac{\phi_0}{1 - \phi_1 - \phi_2 - \phi_3}

```{r}
# Establish coefficents of AR(3) model.
phi_0 <- 0.006
phi_1 <- 0.168
phi_2 <- 0.338
phi_3 <- -0.189

# Calculated expected growth or \mu.
E_rt <- phi_0 / (1 - phi_1 - phi_2 - phi_3)

E_rt

E_rt * 100
```

As such, the expected growth rate of $r_t$ is $0.878\%$.

#### b.

*Does the model imply existence of business cycles? Why?*

$$\phi(B) = 1 - 0.168B - 0.338B^2 + 0.189B^3$$

where $B$ is the backshift or lag operator.

```{r}
# Coefficients of the polynomial in ascending order
coefficients <- c(1, -0.168, -0.338, 0.189)

# Compute the roots
roots <- polyroot(coefficients)

print(roots)
```

Since the roots of the charateristic polynommial of the $\text{AR}$ model are :

$$1.608257 \pm 1.057496i, 1.428154$$

This implies that are are oscillatory or cyclical behavior in the series because of the complex roots.

The magnitude or modulus of a complex number is $\sqrt{a^2 + b^2}$. In this case, it is the following:

```{r}
# Compute modulus of complex root.
a <- 1.608257
b <- 1.057496

sqrt(a^2 + b^2)
```

It is approximately $1.92$, and since it is greater than $1$, it indicates that the business cycles will not only persist but also grow over time. 

#### c.

*What is the average length of business cycles of the economy, if any?*

In order to find the average length of the business cycle introduced by a complex root, we can examine the argument (or angle) of the complex number.

For a complex number $a + bi$, the angle $\theta$ in radians is calculated as:

$$\theta = \arctan{b, a}$$

The length of the business cycle in discrete time periods (like quarters) can be determined as:

$$\text{Length} = \frac{2\pi}{\theta}$$

```{r}
# Calculate angle in radians.
theta <- atan2(b, a)

# Calculate the length of the business cycle in quarters.
cycle_length <- 2 * pi / theta

cycle_length

# Convert quarters to years.
cycle_length / 4
```

As such, the average length of business cycles of the economy is $10.8$ quarters or $2.7$ years.

## Problem 3

The quarterly gross domestic product implicit price deflator is often used as a measure of inflation. The file **q-gdpdef.txt** contains the data for the United States from the first quarter of 1947 to the last quarter of 2008. Data format is year, month, day, and deflator. The data are seasonally adjusted and equal to 100 for year 2000.

```{r}
# Establish the directory for data.
data_directory <- "C:/Users/sbhatia2/My Drive/University/Academics/Semester V/FA542 - Time Series with Application to Finance/FA542 - Exams/FA542 - Midterm Exam/"

# Load in the dataset.
gdp_deflator <- read.table(paste(data_directory, 'q-gdpdef.txt', sep=""), header = T)

# Convert the year, month, and day into a Date object
gdp_deflator$date <- as.Date(with(gdp_deflator, paste(year, mom, day, sep="-")), format="%Y-%m-%d")

# Move 'date' column to the first position and remove nonessential columns.
gdp_deflator <- gdp_deflator[, c("date", "gdpdef")]

head(gdp_deflator)

# Plot the data
plot(gdp_deflator$date, gdp_deflator$gdpdef, type="l", xlab="Date", ylab="GDP Deflator")
```

#### a.

*Build an ARIMA model for the series and check the validity of the fitted model.*

```{r}
library(tseries)

adf.test(gdp_deflator$gdpdef)
```

Since the p-value is greater than $0.05$, we cannot reject the null hypothesis that the data is nonstationary at the $5\%$ significance level. As such, we must difference it.

```{r}
adf.test(diff(gdp_deflator$gdpdef))

adf.test(diff(diff(gdp_deflator$gdpdef)))
```

After differencing twice, we can reject the null hypothesis of a unit root, meaning the data is stationary. 

```{r}
library(forecast)

# Create ARIMA model based on data.
arima_model <- auto.arima(gdp_deflator$gdpdef)

summary(arima_model)$

# Check the residuals to validate the model.
checkresiduals(arima_model)

# Conduct the Ljung-Box test on the residuals
ljung_box_result <- Box.test(arima_model$residuals, lag=log(length(arima_model$residuals)))

ljung_box_result
```

The fitted model is $\text{ARIMA}(p = 0, d = 2, q = 1)$, or a $\text{MA}(2)$ model that is differenced twice.

Since the p-value for the Ljung-Box test is greater than $0.05$, we fail to reject the null hypothesis that the residuals have significant autocorrelations up to the specified lag. As such, the residuals seem to behave like white noise, validating the model. 

#### b.

*Use the fitted model to predict the inflation for each quarter of 2009.*

```{r}
forecast_values <- forecast(arima_model, h = 4)
forecast_values

forecast_values$mean
```
